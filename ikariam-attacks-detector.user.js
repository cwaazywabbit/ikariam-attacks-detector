// ==UserScript==
// @name         Ikariam Attacks Detector
// @namespace    http://ikariam.ninja/
// @version      0.51
// @author       CwaazyWabbit
// @description  try to take over the world!
// @match        http*://*.ikariam.gameforge.com/*
// @require      https://greasyfork.org/scripts/3622-ikariam-developer-tools-v0-5-0/code/Ikariam Developer Tools V050+.user.js
// @require      https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js
// @require      https://raw.githubusercontent.com/mckamey/countdownjs/master/countdown.min.js
// @require      https://raw.githubusercontent.com/icambron/moment-countdown/master/dist/moment-countdown.min.js
// @require      https://raw.githubusercontent.com/kamranahmedse/jquery-toast-plugin/master/dist/jquery.toast.min.js
// @updateURL    https://github.com/cwaazywabbit/ikariam-attacks-detector/raw/master/ikariam-attacks-detector.user.js
// @downloadURL  https://github.com/cwaazywabbit/ikariam-attacks-detector/raw/master/ikariam-attacks-detector.user.js
// @resource     toastCss https://raw.githubusercontent.com/kamranahmedse/jquery-toast-plugin/master/dist/jquery.toast.min.css
// @grant        unsafeWindow
// @grant        GM_getResourceText
// @grant        GM_addStyle
// ==/UserScript==

eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('7 H=\'2s\',l=6(a,b){7 c=2q 2l(\'(\\\\d+)\'+b,\'g\').2k(a);T(c?c[1]:0)},14=6(){$.5().Q(\'2j\')},S=6(a,b,c,e){7 f=2i(6(){a=4.8(a.17()-b,\'1r\');7 d=4.8(a).2h(),h=4.8(a).O(),m=4.8(a).K(),s=4.8(a).M();d=$.y(d).x===1?\'0\'+d:d;h=$.y(h).x===1?\'0\'+h:h;m=$.y(m).x===1?\'0\'+m:m;s=$.y(s).x===1?\'0\'+s:s;$(\'#12\'+c).3((d*1?d+\'يوم \':\'\')+(h*1?h+\'سا \':\'\')+(m*1?m+\'د \':\'\')+(s*1?s+\'ثا\':\'\'));9(a.17()===0){1f(f);e.Q()}},b);T f};(6(){\'2g 2e\';7 i=2d(\'2c\');1p(i);1p(\'.5-3 p { 2b: 2a; 3-B: 29 }\'+\'.n-5-k { 3-B: 28; }\'+\'.5-3 p, .n-5-k b, .5-3 a, .n-5-k a { U-24: 23,22; U-1y: 20; }\'+\'.5-3 p, .n-5-k b { 1Y: 1W; }\'+\'.5-3 a { 3-1U: 1T; }\'+\'.n-5-k E { 1S-B: 1R; }\');r.18.1Q(6 1P(h){r.1O.1N(h,6 1M(d,e,f){9(f&&f.1e){H=f.1e}9(e==r.G.Z.1I){}1H 9(e==r.G.Z.1G){7 g=f[0];9(g==r.G.18.1E){14();$(\'.1D\').1C(6(){7 a=$(1B),2=a.j(\'2\'),L=l(2,\'\'),1q=$(\'#\'+2+\'1A\').3(),N=$(\'#\'+2+\'21\').3(),o=$(\'#\'+2+\'1z\').3(),1w=$(\'#\'+2+\'1x\').j(\'P\'),1t=$(\'#\'+2+\'1x\').j(\'z\'),1m=$(\'#\'+2+\'1l\').j(\'P\'),1k=$(\'#\'+2+\'1l\').j(\'z\'),1j=$(\'#\'+2+\'1F\').j(\'P\'),1i=$(\'#\'+2+\'J\').I(\'1J\')||$(\'#\'+2+\'J\').I(\'1K\')||$(\'#\'+2+\'J\').I(\'1L\')?\'<E 1d="\'+1c.1b+\'//\'+1a.19+\'/16/15/13/D-1V.11" />\':\'<E 1d="\'+1c.1b+\'//\'+1a.19+\'/16/15/13/D-1X.11" />\',10=$(\'#\'+2+\'1Z\').3();9(1q===\'(في رحلة)\'){7 b=l(o,\'يوم\'),O=l(o,\'ساعة\'),K=l(o,\'د\'),M=l(o,\'ثا\'),C=H,Y=4(4.X(C).q(b,\'t\').q(O,\'25\').q(K,\'26\').q(M,\'27\'),\'u-v-A 1s:1o:1n\'),1h=4(Y).2f(4(),\'t\'),1g=4(1h?4().1u(\'t\').W(\'u-v-A\')+\' \'+N:4().1u(\'t\').q(1,\'t\').W(\'u-v-A\')+\' \'+N,\'u-v-A 1s:1o:1n\').X(),F=1g-C,8=4.8(F*R,\'1r\');9(F>0){7 c=$.5({k:\'<b>\'+1i+\' رصدنا تحركًّا معاديًّا باتجاه <a z="\'+1k+\'">\'+1m+\'</a></b>\',3:\'<w 2m="5-3">\'+\'<p><b>الاشتباك خلال:</b> <w 2="12\'+L+\'"></w></p>\'+\'<p><b>المهاجم:</b> \'+1j+\' <b>من:</b> <a z="\'+1t+\'">\'+1w+\'</a></p>\'+\'<p><b>عدد الوحدات:</b> \'+10+\'</p>\'+\'</w>\',2n:2o,2p:1v,D:\'2r\',}),V=S(8,R,L,c);c.2t({2u:6(){1f(V)}})}}})}}})},1v)})();',62,155,'||id|text|moment|toast|function|var|duration|if||||||||||attr|heading|matchPart||jq|arrivesIn||add|IkaTools||day|DD|MM|span|length|trim|href|YYYY|align|currentTime|icon|img|diffTime|Constants|serverTimestamp|hasClass|MissionIcon|minutes|uid|seconds|arrivalDate|hours|title|reset|1000|createInterval|return|font|intId|format|unix|estArrival|IkariamAjaxResponseType|units|png|engageOn|military|resetAllNotifications|advisors|skin|asMilliseconds|View|domain|document|protocol|location|src|time|clearInterval|eventTime|isSameDay|attackType|attacker|attackingCityLink|TargetLink|attackingCity|ss|mm|GM_addStyle|state|milliseconds|HH|attackerCityLink|startOf|true|attackerCity|OriginLink|size|ArrivalTime|State|this|each|hostile|MILITARY_ADVISOR|OriginAvatar|CHANGE_VIEW|else|UPDATE_GLOBAL_DATA|blockade|deployfleet|defend_port|lookForChangeView|iterateIkariamAjaxResponse|Utils|handlejaxResponse|registerIkariamAjaxResponseCallback|middle|vertical|none|decoration|seafight|rtl|groundfight|direction|Units|10px|ArrivalDate|Arial|Tahoma|family|hour|minute|second|center|right|white|color|toastCss|GM_getResourceText|strict|isSame|use|days|setInterval|all|exec|RegExp|class|hideAfter|false|allowToastClose|new|error|undefined|update|afterHidden'.split('|'),0,{}))
